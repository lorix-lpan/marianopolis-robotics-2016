<h1 class="text-center" style="font-size:2em">Tutoriel de Suivi de la Ligne</h1>
<h3 class="text-right">Derek Yu & Bilun Sun. 31 Janvier 2016</h3>
<br>
<p>
  Veux-tu apprendre comment programmer un robot afin qu’il soit autonome, comme suivre une ligne? Certaines personnes peuvent trouver cette tâche un peu difficile, mais c’est beaucoup plus facile que vous pensez. Dans ce simple tutoriel, nous allons utiliser trois détecteur de ligne VEX, mais vous pouvez en utiliser plus si vous voulez. Plus vous en utilisez, mieux sera le résultat. Êtes-vous prêt? Commençons!
</p>
<p>
  Commencez par ouvrir un nouveau fichier. Le programme que nous utilisons est RobotC.
</p>
<div hljs>
task main()
{

}
</div>
<p>
  Ensuite, il faut que le VEX Cortex sache dans quels ports les moteurs et les capteurs sont branchés. Nous utilisons 2 moteurs VEX pour ce tutoriel : un pour la gauche, et un autre pour la droite. Appuyer sur le bouton <b>Motor and Sensor Setup.</b>
</p>
<img class="img-responsive" src="../../../../../assets/img/tutorials/tutorial_robot.png">
<p>
  Sous l’onglet Motors, attribuez un nom à vos moteurs dans les ports correspondants à ceux du VEX Cortex. Cliquez sur Type, et sélectionnez les moteurs que vous utilisez. Ensuite, cochez la case Reversed pour un des moteurs. Cela fait en sorte que les deux moteurs tournent dans la même direction. Puis, attribuez des noms à vos capteurs, sous l’onglet VEX 2.0 Analog Sensors 1-8.
</p>
<p>
Maintenant, nous allons définir deux variables : speed (vitesse) et threshold (seuil/limite). La variable pour la vitesse n’est pas essentielle, mais lorsque vous voulez changez la vitesse à laquelle le robot bouge, c’est plus pratique. Choisissez n’importe quelle vitesse que vous voulez, mais nous suggérons de commencer autour le 30, puisque ce sera plus facile pour le robot à suivre la ligne. Une fois que vous avez finis et testé le code, vous pouvez facilement augmenter la vitesse. L’autre variable, pour le seuil, permet au robot de différentier entre la surface et la ligne. Cette valeur est obtenue expérimentalement, mais vous pouvez commencer par la moyenne entre le maximum et le minimum détecté par vos capteurs.
</p>
<p>
NOTE : La valeur des capteurs est élevée (2000-3000) lorsqu’ils sont placés sur une surface sombre/noir. Sur une surface pâle/blanche, la valeur est plus basse (autour de 200). </p>
<div hljs>
#pragma config(Sensor, in1,    leftIR,         sensorLineFollower)
#pragma config(Sensor, in2,    middleIR,       sensorLineFollower)
#pragma config(Sensor, in3,    rightIR,        sensorLineFollower)
#pragma config(Motor,  port2,           rightMotor,     tmotorVex393_MC29, openLoop)
#pragma config(Motor,  port3,           leftMotor,    tmotorVex393_MC29, openLoop, reversed)
//*!!Code automatically generated by 'ROBOTC' configuration wizard               !!*//

int speed = 50;
int threshold = 1300;

task main()
{

}
</div>
<p>
Une fois que tout est prêt, il est temps de commencer à programmer! </p>
<p>
  Le code montré ci-dessus montre seulement comme suivre une ligne. Si vous désirez que le robot s’arrête à cause d’une raison X, vous pouvez ajouter votre propre code à la fin du nôtre.
</p>
<p>
  Pour commencer, créez un while loop, dans lequel nous allons écrire le code pour suivre une ligne. Le paramètre est true, puisque nous voulons que le code soit exécuté continuellement. Ensuite, nous avons besoin de 3 if statements, pour déterminer l’emplacement de la ligne par rapport au robot, et bouger le robot en conséquence. Pour ce faire, la valeur des capteurs est comparée à la valeur de la variable threshold : si le premier est plus grand que le second, cela signifie que la ligne se trouve sous ce capteur; il faut donc bouger le robot afin que la ligne se retrouve au milieu du robot. Par exemple, si la ligne se trouve à gauche du robot, il faut que le moteur droit tourne (et que le moteur gauche s’arrête) pour que le robot tourne à gauche. Finalement, si la ligne se retrouve sous le milieu du robot, le robot avance en ligne droite.
</p>
<div hljs>
#pragma config(Sensor, in1,    leftIR,         sensorLineFollower)
#pragma config(Sensor, in2,    middleIR,       sensorLineFollower)
#pragma config(Sensor, in3,    rightIR,        sensorLineFollower)
#pragma config(Motor,  port2,           rightMotor,     tmotorVex393_MC29, openLoop)
#pragma config(Motor,  port3,           leftMotor,    tmotorVex393_MC29, openLoop, reversed)
//*!!Code automatically generated by 'ROBOTC' configuration wizard               !!*//

int speed = 50;
int threshold = 1300;

task main()
{
	while(true){
		if (SensorValue(leftIR) > threshold){ //If line is on the left side, turn robot left
			motor[leftMotor] = 0;
			motor[rightMotor] = speed;
		}

		if (SensorValue(middleIR) > threshold){
			motor[leftMotor] = speed;
			motor[rightMotor] = speed;
		}

		if (SensorValue(rightIR) > threshold){
			motor[leftMotor] = speed;
			motor[rightMotor] = 0;
		}
	}
}
</div>
